# SECUENCIA DE SPRINTS - VIBE CODING

## SPRINT 1: Infraestructura y Auth
**Prompt:**
> "Usa el  archivo: @00.supabase.blueprint.md como blueprint.
Genera el SQL para crear todas las tablas con sus tipos de datos y foreign keys. Incluye el Trigger de Postgres `on_auth_user_created` para insertar automáticamente en la tabla `profiles` cuando un usuario se registre en Supabase Auth. No actives RLS todavía.
Usa un archivo .env para guardar las variables de entorno.
Usa el MCP de supabase que hemos activado.
"

## SPRINT 2: Blindaje RLS
**Prompt:**
> "Ahora vamos a securizar la DB. Genera el SQL para activar RLS en todas las tablas. Crea las políticas específicas: 
> 1. Los residentes solo ven su propio perfil.
> 2. Los residentes solo ven amenities activos y anuncios publicados.
> 3. Los residentes pueden ver y cancelar sus propias reservas, pero no borrarlas.
> 4. Los admins tienen bypass total (ALL) en todas las tablas."

## SPRINT 3: El Cerebro (Edge Function)
**Prompt:**
> "Implementa la Edge Function `validate-booking` en Deno. La función debe:
> 1. Recibir amenity_id, date, start_time y end_time.
> 2. Validar contra `app_settings` (anticipación mínima, duración max).
> 3. Verificar en la DB que no haya solapamiento de horarios (Overlap).
> 4. Si es válido, insertar la reserva usando el Service Role Key.
> 5. Retornar error descriptivo si falla alguna regla."

## SPRINT 4: Integración Frontend y Realtime
**Prompt:**
> "Configura el `supabase-js` en el frontend. Reemplaza el estado local de la lista de reservas por una suscripción Realtime a la tabla `bookings`. Implementa la llamada a la Edge Function `validate-booking` desde el formulario de reserva y maneja los errores devueltos para mostrarlos en la UI."

## SPRINT 5: Ajustes de Admin y Cierre
**Prompt:**
> "Crea la interfaz de administración para `app_settings` que permita al admin cambiar los límites (ej: bajar de 24h a 12h de anticipación). Asegúrate de que los cambios se reflejen inmediatamente en la lógica de la Edge Function."