##  EL BLUEPRINT (Contexto Único)

*cada vez que empieces un prompt, solo dices: "Sigue las reglas de `blueprint.md`".*


```markdown
# PROYECTO: GESTIÓN DE EDIFICIOS (3-TIER)
- Stack: Node/Express + Supabase (Service Role) + React.
- Seguridad: JWT en Backend, sin RLS en Supabase.
- Reglas Oro: Validar siempre en Backend; Service Key NUNCA al Front.
- Tablas: users, amenities, bookings (unique constraints), announcements, app_settings.

```

---

## PROMPTS DE EJECUCIÓN (Sprints)

### Sprint 1: El Cimiento (Infra & Auth)

> **Prompt:** "Basado en `blueprint.md`, genera el SQL para las 5 tablas con sus constraints y datos iniciales en `app_settings`. Luego, inicializa el backend Express con el cliente de Supabase, middleware de JWT y los endpoints de `auth/register` (con bcrypt) y `auth/login`. Que el login devuelva el rol y el token."

### Sprint 2: El Cerebro (Amenities & Config)

> **Prompt:** "Implementa el CRUD de `amenities` (Admin: todo / Resident: solo lectura). Crea un `settings.service.js` que cachee o lea los valores de `app_settings` (como horas de anticipación). Asegura que el `roleCheck.js` bloquee correctamente a los residentes de crear amenities."

### Sprint 3: La Joya de la Corona (Bookings Logic)

> **Prompt:** "Implementa `booking.service.js`. Debe validar: 1. Fecha futura. 2. Anticipación mínima (de settings). 3. No solapamientos de horario en la DB. 4. Límite de reservas por usuario. Luego, crea los endpoints de `bookings` para que los residentes creen y cancelen sus propias reservas."

### Sprint 4: El Puente (Frontend Bridge)

> **Prompt:** "Configura el frontend: crea un `api.js` usando Axios con interceptores para inyectar el JWT automáticamente y manejar errores 401. Implementa los servicios de `auth.service.js` y `amenities.service.js` para conectar las interfaces actuales con la nueva API."

### Sprint 5: Cierre & Seguridad (Polish)

> **Prompt:** "Añade Rate Limiting a los endpoints de auth. Implementa el módulo de `announcements` (solo admins publican). Finalmente, genera un script de prueba manual (curl o postman) para verificar que un residente no pueda borrar una reserva de otro."
